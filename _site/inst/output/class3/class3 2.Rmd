---
title: Tidybiology
subtitle: Intro to Data Science using R
author: Matthew Hirschey & Akshay Bareja
date: '2020-11-09'
output:
  ioslides_presentation:
    widescreen: yes
runtime: shiny_prerendered
---
```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
library(knitr)
library(here)
library(twitterwidget)
library(rlang)
library(ggrepel)
library(viridis)
library(gghighlight)
library(patchwork)
knitr::opts_chunk$set(echo = FALSE, 
                      fig.align="center")
```

```{r load, include = FALSE}
path <- '/Users/akshaybareja/Desktop/R Stuff/Reactivity Testing/bespokelearnr/inst/extdata'
proteins <- readRDS(paste0(path, '/bespoke_dataframe.Rds'))
###
proteins_join <- readRDS(paste0(path, '/bespoke_dataframe_join.Rds'))
joined <- proteins %>% right_join(proteins_join, by = 'id')
###
df_input <- proteins # this line is for bespoke.R to get proper var
df_input2 <- proteins_join
source('/Users/akshaybareja/Desktop/R Stuff/Reactivity Testing/bespokelearnr/inst/content/metadata.R', local = TRUE)
source('/Users/akshaybareja/Desktop/R Stuff/Reactivity Testing/bespokelearnr/inst/content/bespoke.R', local = TRUE)
```
# "The simple graph has brought more information to the data analyst’s mind than any other device."  -- John Tukey

## Visualize Data with
```{r ggplot_logo, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="", out.height = '100%'}
url <- "https://github.com/tidyverse/ggplot2/raw/master/man/figures/logo.png"
knitr::include_graphics(url)
```
<font size = "1">[https://ggplot2.tidyverse.org](https://ggplot2.tidyverse.org)</font>

## Basics of a ggplot code {.build}

Below is an example of the most basic form of the ggplot code  
  
`ggplot(data = dataframe) +`   
  `geom(mapping = aes(x, y))`  
  
Take a moment to look back at the code template.  You can see that in that code we assigned a `dataset` and the information we needed to `map` it to a type of plot

## Basics of a ggplot code {.build}
  
`ggplot(data = `r dataframe_name`) +`  
`geom_point(mapping=aes(x = `r df_numeric1_name`, y = `r df_numeric2_name`))`  
  
```{r simple_plot, echo = FALSE, warning = FALSE}
df_input %>% 
  ggplot(aes(!!sym(df_numeric1_name), !!sym(df_numeric2_name))) +
  geom_point() 
```

## Build a `ggplot` {.build}
- "Initialize" a plot with `ggplot()`  
  
`ggplot(data = `r dataframe_name`) +`  
  
- Add layers with `geom_functions`  
  
`geom_point(mapping=aes(x = `r df_numeric1_name`, y = `r df_numeric2_name`))`  

## Notes on `ggplot` style {.build}
- Generally, different people have **strong** opinions about style and data visualization  
  
- Data visualization is a rich and complex area of study and is beyond the scope of this introductory course  
  
**That being said, here are a few style tips:**    
- While you can put the `+` at the beginning of the next line, it is generally put at the end of the previous line    
  
- Arguments do not need to be explicit: this chunk of code is equivalent to the previous chunk (w/ data, mappings)  
`ggplot(`r dataframe_name`) +`    
`geom_point(aes(x = `r df_numeric2_name`, y = `r df_numeric2_name`))`  

## Aesthetics
Everything up to this point gets you a basic graph; but what about colors, shapes and overall style?  
  
You can change 5 basic aesthetics  
1. **Color**- changes the outline color of your datapoints  
2. **Size** - choose the size of the datapoint  
3. **Shape** - choose a pre-defined shape  
4. **Alpha**- changes the transparency of each point  
5. **Fill**- changes the fill color of your points  
  
  
## Mapping these aesthetics to data
Beyond simply changing the size or color of the variables in your plot, you can encode more information by mapping these values to data in your data set.  
  
  
## Global vs Local {.build}
In ggplot2, we have the options to set mappings globally or locally. Setting a mapping globally means to set those values in the original ggplot function.  
  
Example:  

`ggplot(`r dataframe_name`) +`  
  `geom_jitter(aes(x=`r df_char1_name`, y=`r df_numeric1_name`))+`  
  `geom_boxplot(aes(x=`r df_char1_name`, y=`r df_numeric1_name`))`  
  
## How are these two plots similar?
```{r double_plot, echo = FALSE, message=FALSE, warning=FALSE}
plot1 <- df_input %>% 
  ggplot(aes(!!sym(df_numeric1_name), !!sym(df_numeric2_name))) +
  geom_point() 

plot2 <- df_input %>% 
  ggplot(aes(!!sym(df_numeric1_name), !!sym(df_numeric2_name))) +
  geom_smooth() 

plot1 + plot2
```

## The `geom` is different between these plots
`geom` is short for geometric object, which is the visual object used to represent the data  
    
`plot1 <- ggplot(`r dataframe_name`) +`  
  `geom_point(aes(`r df_numeric1_name`, `r df_numeric2_name`))`   
  
`plot2 <-  ggplot(`r df_numeric1_name`, `r df_numeric2_name`) +`  
  `geom_smooth(aes(`r df_numeric1_name`, `r df_numeric2_name`))`   

## Choosing your (geom)etries
Different data types require different plot types.  
  
When plotting your data, it is often helpful to take a glimpse at the data you intend to plot to know what kinds of variables you will be working with

`glimpse(`r dataframe_name`)`
```{r glimpse_again, exercise=TRUE}

```

## Geoms 
So now that you know your variable types, how do you know what geoms to use??  
  
Use the following resources to match your data type to the appropriate `geoms`

----
<a href="https://rstudio.com/resources/cheatsheets" target="_blank">https://rstudio.com/resources/cheatsheets/</a><br>
<center><iframe src="https://rstudio.com/resources/cheatsheets"></iframe></center>

----
<a href="https://www.data-to-viz.com/" target="_blank">https://www.data-to-viz.com/</a><br>
<center><iframe src="https://www.data-to-viz.com/"></iframe></center>

## Change this scatterplot code to draw boxplots {.smaller} 
`ggplot(`r dataframe_name`) + geom_point(aes(x=`r df_char1_name`,y=`r df_numeric1_name`))`  
```{r boxplot_activity, exercise = TRUE}

```
  
Use the cheatsheet. Try your best guess.  

## What will this code do?
  
`ggplot(`r dataframe_name`) +`   
`geom_boxplot(aes(x=`r df_char1_name`,y=`r df_numeric1_name`)) +`  
`geom_point(aes(x=`r df_char1_name`,y=`r df_numeric1_name`))`  

## Try including two `geoms` for yourself
```{r 2geom_activity, exercise = TRUE}

```
  
**Each new geom adds a new layer**  

## Labels and Legends
Several options exist to change the default labels and legends. Recall, this code:  
  
`ggplot(`r dataframe_name`, aes(x=`r df_char1_name`, y=`r df_numeric1_name`) +`  
`geom_jitter() +`    
`geom_boxplot(aes(color = `r df_char1_name`))`   

## Labels and Legends {.build}
```{r labs, echo = FALSE, warning = FALSE}
original_plot <- ggplot(df_input, aes(!!sym(df_char1_name), !!sym(df_numeric1_name))) +
  geom_jitter() +
  geom_boxplot(aes(color = !!sym(df_char1_name)))
original_plot
```
  
But it has two problems:  
1. The x-axis label is redundant  
2. The figure legend is also redundant  

## Change labels using `labs`
`ggplot(`r dataframe_name`, aes(x=`r df_char1_name`, y=`r df_numeric1_name`) +`  
`geom_jitter() +`    
`geom_boxplot(aes(color = `r df_char1_name`)) +`  
`labs(x ="") #blank quotes removes the label`

## Change labels using `labs`
Gave us this plot:  
```{r labs_fix, echo = FALSE, warning = FALSE}
ggplot(df_input, aes(!!sym(df_char1_name), !!sym(df_numeric1_name))) +
  geom_jitter() +
  geom_boxplot(aes(color = !!sym(df_char1_name))) +
  labs(x = "")
```

## Change legend using `guides`
`ggplot(`r dataframe_name`, aes(x=`r df_char1_name`, y=`r df_numeric1_name`) +`  
`geom_jitter() +`    
`geom_boxplot(aes(color = `r df_char1_name`)) +`  
`labs(x ="") #blank quotes removes the label +`  
`guides(color = "none")`

## Change legend using `guides` 
```{r guides, echo = FALSE, warning = FALSE}
lab_plot <- ggplot(df_input, aes(!!sym(df_char1_name), !!sym(df_numeric1_name))) +
  geom_jitter() +
  geom_boxplot(aes(color = !!sym(df_char1_name))) +
  labs(x = "") + 
  guides(color = "none")
original_plot + lab_plot
```
## Faceting {.build}
Faceting allows you to create multiple graphs side by side in one panel. Especially useful when you want to see the data together, but not on top of each other  
  
For example:  
  
`ggplot(`r dataframe_name`) +`  
`geom_point(aes(x=`r df_char1_name`, y=`r df_numeric1_name`)) +`  
`facet_grid(cols = vars(`r df_char2_name`))`

## Faceting
```{r facetting, echo = FALSE, warning = FALSE}
ggplot(df_input, aes(!!sym(df_char1_name), !!sym(df_numeric1_name))) +
  geom_point() +
  facet_grid(cols = vars(!!sym(df_char2_name)))
```
  
*This is especially useful for exploratory data analysis

## Themes {.build}
You can change almost everything you see on your chart, but a lot of the things you may look to change are part of the "theme"  
  
Here we are going to change some features about our title text:  
  
`ggplot(`r dataframe_name`, aes(x=`r df_char1_name`, y=`r df_numeric1_name`) +`  
`geom_jitter() +`    
`geom_boxplot(aes(color = `r df_char1_name`)) +`  
`labs(title = "My first plot") +`  
`theme(plot.title = element_text(face = "bold", size = 12))` 

## Themes {.build}
```{r themes, echo = FALSE, warning = FALSE}
theme1 <- ggplot(df_input, aes(!!sym(df_char1_name), !!sym(df_numeric1_name))) +
  geom_jitter() +
  geom_boxplot(aes(color = !!sym(df_char1_name))) +
  labs(title = "My first plot") +
  theme(plot.title = element_text(face = "bold", size = 12)) 
original_plot + theme1
```

## Themes {.build}
Next, let's change the aesthetics of our legend box  
  
`ggplot(`r dataframe_name`, aes(x=`r df_char1_name`, y=`r df_numeric1_name`) +`  
`geom_jitter() +`    
`geom_boxplot(aes(color = `r df_char1_name`)) +`  
`labs(title = "My first plot") +`  
`theme(plot.title = element_text(face = "bold", size = 12),`  
`legend.background = element_rect(fill="gray", colour="black"))`   

## Themes {.build}
```{r themes2, echo = FALSE, warning = FALSE}
theme2 <- ggplot(df_input, aes(!!sym(df_char1_name), !!sym(df_numeric1_name))) +
  geom_jitter() +
  geom_boxplot(aes(color = !!sym(df_char1_name))) +
  labs(title = "My first plot") +
  theme(plot.title = element_text(face = "bold", size = 12), 
        legend.background = element_rect(fill="gray", colour="black")
  ) 
theme1 + theme2
```

## Themes {.build}
Finally, let's change the legend position  
  
`ggplot(`r dataframe_name`, aes(x=`r df_char1_name`, y=`r df_numeric1_name`) +`  
`geom_jitter() +`    
`geom_boxplot(aes(color = `r df_char1_name`)) +`  
`labs(title = "My first plot") +`  
`theme(plot.title = element_text(face = "bold", size = 12),`  
`legend.background = element_rect(fill="gray", colour="black"),`  
`legend.position = "bottom"))` 

## Themes {.build}
```{r themes3, echo = FALSE, warning = FALSE}
theme3 <- ggplot(df_input, aes(!!sym(df_char1_name), !!sym(df_numeric1_name))) +
  geom_jitter() +
  geom_boxplot(aes(color = !!sym(df_char1_name))) +
  labs(title = "My first plot") +
  theme(plot.title = element_text(face = "bold", size = 12), 
        legend.background = element_rect(fill="gray", colour="black"),
        legend.position = "bottom"
  ) 
theme2 + theme3
```

## Themes {.build}
Pre-set themes also exist as an easy way to change the entire theme of your graph quickly. They can also be combined with custom theme settings  

`ggplot(`r dataframe_name`, aes(x=`r df_char1_name`, y=`r df_numeric1_name`) +`  
`geom_jitter() +`    
`geom_boxplot(aes(color = `r df_char1_name`)) +`  
`labs(title = "My first plot") +`  
`theme_minimal()`  

## Themes {.build}
```{r themes4, echo = FALSE, warning = FALSE}
theme4 <- ggplot(df_input, aes(!!sym(df_char1_name), !!sym(df_numeric1_name))) +
  geom_jitter() +
  geom_boxplot(aes(color = !!sym(df_char1_name))) +
  labs(title = "My first plot") +
  theme_minimal()
theme1 + theme4
```



## Saving plots using `ggsave` {.build}

If you make a plot there are a few ways to save it, though the simplest is to use `ggsave`  

`ggsave("ggsaveexample.png", plot = last_plot())`  

You can change the type of file you save or the size.  
  
`ggsave("ggsaveexample.pdf", plot = my_awesome_object, width = 6, height = 6, units = "cm")`  

## Saving plots using ggsave
Where does it save??  
  
`getwd()`
# Concluding Thoughts

## Data science enables {.build}
- Data science enables data-driven information gathering and hypothesis generation  
-- Scientific Research  
-- Reviews  
  
- Data science enables the ability to ask new types of questions  
  
- Process-centric, not necessarily question-centric  
  
- Making things computable makes them actionable at zero marginal cost.  
  
- Workflows save time, achieve reproducibility  

## Cheatsheet Resources
<a href="https://rstudio.com/resources/cheatsheets" target="_blank">Cheatsheets</a><br>
<center><iframe src="https://rstudio.com/resources/cheatsheets"></iframe></center>

## Google Resources
<a href="https://google.com/" target="_blank">Google.com</a><br>
<center><iframe src="https://google.com"></iframe></center>

## R4DS Resources
<a href="https://r4ds.had.co.nz" target="_blank">R for Data Science</a><br>
<center><iframe src="https://r4ds.had.co.nz"></iframe></center>
## Tidybiology Website
<a href="https:/tidybiology.org" target="_blank">tidybiology.org</a><br>
<center><iframe src="https://tidybiology.org"></iframe></center>

## Tidybiology Videos
<a href="https://www.youtube.com/channel/UCstAS6IpgYgZ9Cvcag_YlCQ" target="_blank">tidybiology YouTube Channel</a><br>
<center><iframe src="https://www.youtube.com/channel/UCstAS6IpgYgZ9Cvcag_YlCQ"></iframe></center>

## Acknowledgements {.build}
**Co-Instructor**  
- Akshay Bareja, D.Phil.  
  
**Inspiration, ideas, packages, code**  
- R4DS (Garrett Grolemund and Hadley Wickham)  
- Mine Çetinkaya-Rundel (datasciencebox.org)  
- Chester Ismay and Albert Y. Kim (Modern Dive)  
- Garrett Grolemund  (Remastering the Tidyverse)  
- Tidyverse devs and community  
- Rstudio  

# Thank you
Any questions?
